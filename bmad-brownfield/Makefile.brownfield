# Makefile para BMAD-Method com Gemini CLI
# Este Makefile automatiza todo o fluxo de trabalho do BMAD-Method para projetos existentes

.PHONY: help install setup-gemini setup-bmad check-deps \
        analyze plan-prd plan-arch validate create-epic create-stories \
        implement-story refactor fix-bug migrate test-connection \
        clean-docs status full-setup brownfield-flow

# Vari√°veis de configura√ß√£o
GEMINI_CLI_VERSION := latest
PROJECT_NAME := $(shell basename $(PWD))
STORY_NUMBER ?= 1.1

# Cores para output
RED := \033[0;31m
GREEN := \033[0;32m
YELLOW := \033[1;33m
BLUE := \033[0;34m
PURPLE := \033[0;35m
CYAN := \033[0;36m
NC := \033[0m # No Color

##@ Ajuda e Informa√ß√µes

help: ## üìã Exibir esta mensagem de ajuda
	@echo "$(CYAN)‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó$(NC)"
	@echo "$(CYAN)‚ïë                    BMAD-Method Makefile                      ‚ïë$(NC)"
	@echo "$(CYAN)‚ïë              Automa√ß√£o para Projetos Existentes             ‚ïë$(NC)"
	@echo "$(CYAN)‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù$(NC)"
	@echo ""
	@echo "$(YELLOW)üì¶ INSTALA√á√ÉO E CONFIGURA√á√ÉO:$(NC)"
	@echo "  $(GREEN)make install$(NC)          - Instalar Gemini CLI e BMAD-Method"
	@echo "  $(GREEN)make setup-gemini$(NC)     - Configurar apenas Gemini CLI"
	@echo "  $(GREEN)make setup-bmad$(NC)       - Configurar apenas BMAD-Method"
	@echo "  $(GREEN)make setup-oauth$(NC)      - Configurar autentica√ß√£o OAuth"
	@echo "  $(GREEN)make check-deps$(NC)       - Verificar depend√™ncias instaladas"
	@echo "  $(GREEN)make test-connection$(NC)  - Testar conex√£o com Gemini API"
	@echo ""
	@echo "$(YELLOW)üöÄ FLUXO COMPLETO (RECOMENDADO):$(NC)"
	@echo "  $(GREEN)make full-setup$(NC)       - Instala√ß√£o completa + configura√ß√£o"
	@echo "  $(GREEN)make brownfield-flow$(NC)  - Executar fluxo completo para brownfield"
	@echo ""
	@echo "$(YELLOW)üìä AN√ÅLISE E DOCUMENTA√á√ÉO:$(NC)"
	@echo "  $(GREEN)make analyze$(NC)          - Documentar estado atual do projeto"
	@echo "  $(GREEN)make plan-prd$(NC)         - Criar PRD para brownfield"
	@echo "  $(GREEN)make plan-arch$(NC)        - Criar arquitetura para brownfield"
	@echo "  $(GREEN)make validate$(NC)         - Executar checklist de valida√ß√£o"
	@echo ""
	@echo "$(YELLOW)üìù CRIA√á√ÉO DE √âPICOS E HIST√ìRIAS:$(NC)"
	@echo "  $(GREEN)make create-epic$(NC)      - Criar √©pico para brownfield"
	@echo "  $(GREEN)make create-stories$(NC)   - Criar hist√≥rias de usu√°rio"
	@echo ""
	@echo "$(YELLOW)üíª IMPLEMENTA√á√ÉO:$(NC)"
	@echo "  $(GREEN)make implement-story$(NC)  - Implementar hist√≥ria espec√≠fica"
	@echo "  $(GREEN)make refactor$(NC)         - Refatorar c√≥digo existente"
	@echo "  $(GREEN)make fix-bug$(NC)          - Corrigir bug complexo"
	@echo "  $(GREEN)make migrate$(NC)          - Migra√ß√£o de tecnologia"
	@echo ""
	@echo "$(YELLOW)üîß UTILIT√ÅRIOS:$(NC)"
	@echo "  $(GREEN)make status$(NC)           - Status das instala√ß√µes"
	@echo "  $(GREEN)make clean-docs$(NC)       - Limpar documenta√ß√£o gerada"
	@echo ""
	@echo "$(YELLOW)üìñ EXEMPLOS DE USO:$(NC)"
	@echo "  $(CYAN)make install$(NC)                    # Primeira instala√ß√£o"
	@echo "  $(CYAN)make brownfield-flow$(NC)           # Fluxo completo"
	@echo "  $(CYAN)make implement-story STORY_NUMBER=1.2$(NC)  # Implementar hist√≥ria espec√≠fica"
	@echo ""
	@echo "$(YELLOW)‚ö†Ô∏è  REQUISITOS:$(NC)"
	@echo "  - Node.js v20+"
	@echo "  - Conta Google para autentica√ß√£o OAuth"
	@echo "  - Projeto existente com estrutura definida"
	@echo ""

##@ Instala√ß√£o e Configura√ß√£o

install: ## üîß Instalar Gemini CLI e BMAD-Method (comando principal)
	@echo "$(CYAN)üöÄ Iniciando instala√ß√£o completa...$(NC)"
	@$(MAKE) setup-gemini
	@$(MAKE) setup-bmad
	@$(MAKE) check-deps
	@echo "$(GREEN)‚úÖ Instala√ß√£o completa finalizada!$(NC)"

setup-gemini: ## ü§ñ Instalar e configurar Gemini CLI
	@echo "$(BLUE)üì¶ Instalando Gemini CLI...$(NC)"
	@if ! command -v gemini >/dev/null 2>&1; then \
		echo "$(YELLOW)‚¨áÔ∏è  Instalando @google/gemini-cli globalmente...$(NC)"; \
		npm install -g @google/gemini-cli; \
	else \
		echo "$(GREEN)‚úÖ Gemini CLI j√° est√° instalado$(NC)"; \
	fi
	@echo "$(BLUE)üîë Verificando configura√ß√£o da API Key...$(NC)"
	@if [ -z "$$GEMINI_API_KEY" ]; then \
		echo "$(RED)‚ùå GEMINI_API_KEY n√£o est√° configurada!$(NC)"; \
		echo "$(YELLOW)üí° Configure com: export GEMINI_API_KEY='sua_api_key'$(NC)"; \
		echo "$(YELLOW)üí° Para tornar permanente: echo 'export GEMINI_API_KEY=\"sua_key\"' >> ~/.bashrc$(NC)"; \
		exit 1; \
	else \
		echo "$(GREEN)‚úÖ GEMINI_API_KEY configurada$(NC)"; \
	fi
	@echo "$(BLUE)üß™ Testando instala√ß√£o do Gemini CLI...$(NC)"
	@gemini --version || (echo "$(RED)‚ùå Erro na instala√ß√£o do Gemini CLI$(NC)" && exit 1)
	@echo "$(GREEN)‚úÖ Gemini CLI instalado e configurado com sucesso!$(NC)"

setup-bmad: ## üéØ Instalar e configurar BMAD-Method
	@echo "$(PURPLE)üì¶ Instalando BMAD-Method...$(NC)"
	@echo "$(YELLOW)‚ö†Ô∏è  Durante a instala√ß√£o, selecione 'Gemini CLI' quando perguntado sobre o IDE$(NC)"
	@echo "$(YELLOW)‚ö†Ô∏è  Escolha 'Complete installation' para projetos existentes$(NC)"
	@echo "$(BLUE)üîÑ Executando instala√ß√£o interativa...$(NC)"
	@npx bmad-method install
	@echo "$(GREEN)‚úÖ BMAD-Method instalado com sucesso!$(NC)"

check-deps: ## ‚úÖ Verificar se todas as depend√™ncias est√£o instaladas
	@echo "$(CYAN)üîç Verificando depend√™ncias...$(NC)"
	@echo "$(BLUE)üìã Verificando Node.js...$(NC)"
	@node --version || (echo "$(RED)‚ùå Node.js n√£o encontrado$(NC)" && exit 1)
	@echo "$(BLUE)üìã Verificando npm...$(NC)"
	@npm --version || (echo "$(RED)‚ùå npm n√£o encontrado$(NC)" && exit 1)
	@echo "$(BLUE)üìã Verificando Gemini CLI...$(NC)"
	@gemini --version || (echo "$(RED)‚ùå Gemini CLI n√£o encontrado$(NC)" && exit 1)
	@echo "$(BLUE)üìã Verificando BMAD-Method...$(NC)"
	@npx bmad-method status || (echo "$(YELLOW)‚ö†Ô∏è  BMAD-Method pode n√£o estar configurado$(NC)")
	@echo "$(BLUE)üìã Verificando autentica√ß√£o OAuth...$(NC)"
	@echo "$(GREEN)‚úÖ Usando autentica√ß√£o OAuth (sem necessidade de API Key)$(NC)"
	@echo "$(YELLOW)üí° Se houver problemas de autentica√ß√£o, execute: make setup-oauth$(NC)"
	@echo "$(GREEN)‚úÖ Todas as depend√™ncias est√£o OK!$(NC)"

test-connection: ## üß™ Testar conex√£o com Gemini API
	@echo "$(BLUE)üîó Testando conex√£o com Gemini API...$(NC)"
	@gemini -p "Hello, this is a connection test. Please respond with 'Connection successful!'" || \
		(echo "$(RED)‚ùå Falha na conex√£o com Gemini API$(NC)" && exit 1)
	@echo "$(GREEN)‚úÖ Conex√£o com Gemini API funcionando!$(NC)"

##@ Fluxos Completos

full-setup: ## üöÄ Configura√ß√£o completa (instala√ß√£o + verifica√ß√£o + teste)
	@echo "$(CYAN)üöÄ Iniciando configura√ß√£o completa do ambiente...$(NC)"
	@$(MAKE) install
	@$(MAKE) test-connection
	@echo "$(GREEN)üéâ Ambiente completamente configurado e testado!$(NC)"
	@echo "$(YELLOW)üí° Pr√≥ximo passo: execute 'make brownfield-flow' para come√ßar$(NC)"

brownfield-flow: ## üîÑ Executar fluxo completo para projetos brownfield
	@echo "$(CYAN)üîÑ Iniciando fluxo completo para projeto brownfield...$(NC)"
	@echo "$(YELLOW)üìä Fase 1: An√°lise e Documenta√ß√£o$(NC)"
	@$(MAKE) analyze
	@echo "$(YELLOW)üìã Fase 2: Planejamento$(NC)"
	@$(MAKE) plan-prd
	@$(MAKE) plan-arch
	@echo "$(YELLOW)‚úÖ Fase 3: Valida√ß√£o$(NC)"
	@$(MAKE) validate
	@echo "$(YELLOW)üìù Fase 4: Cria√ß√£o de √âpicos$(NC)"
	@$(MAKE) create-epic
	@echo "$(GREEN)üéâ Fluxo brownfield completo! Pr√≥ximos passos:$(NC)"
	@echo "$(CYAN)  1. make create-stories     # Criar hist√≥rias detalhadas$(NC)"
	@echo "$(CYAN)  2. make implement-story    # Implementar primeira hist√≥ria$(NC)"

##@ An√°lise e Documenta√ß√£o

analyze: ## üìä Documentar estado atual do projeto
	@echo "$(BLUE)üìä Analisando estado atual do projeto '$(PROJECT_NAME)'...$(NC)"
	@echo "$(YELLOW)‚è±Ô∏è  Tempo estimado: 5-10 minutos$(NC)"
	@echo "$(CYAN)ü§ñ Executando: @analyst *document-project$(NC)"
	@gemini -p "@analyst *document-project" || \
		(echo "$(RED)‚ùå Erro na an√°lise do projeto$(NC)" && exit 1)
	@echo "$(GREEN)‚úÖ An√°lise do projeto conclu√≠da!$(NC)"
	@echo "$(BLUE)üìÑ Documentos gerados: docs/project-analysis.md$(NC)"

plan-prd: ## üìã Criar PRD para brownfield
	@echo "$(PURPLE)üìã Criando PRD para projeto brownfield...$(NC)"
	@echo "$(YELLOW)‚è±Ô∏è  Tempo estimado: 15-20 minutos$(NC)"
	@echo "$(YELLOW)üí° Voc√™ ser√° questionado sobre melhorias desejadas$(NC)"
	@echo "$(CYAN)ü§ñ Executando: @pm *create-doc brownfield-prd$(NC)"
	@gemini -p "@pm *create-doc brownfield-prd" || \
		(echo "$(RED)‚ùå Erro na cria√ß√£o do PRD$(NC)" && exit 1)
	@echo "$(GREEN)‚úÖ PRD para brownfield criado!$(NC)"
	@echo "$(BLUE)üìÑ Documento gerado: docs/prd.md$(NC)"

plan-arch: ## üèóÔ∏è Criar arquitetura para brownfield
	@echo "$(CYAN)üèóÔ∏è  Criando arquitetura para projeto brownfield...$(NC)"
	@echo "$(YELLOW)‚è±Ô∏è  Tempo estimado: 20-30 minutos$(NC)"
	@echo "$(YELLOW)üí° Voc√™ ser√° questionado sobre arquitetura atual$(NC)"
	@echo "$(CYAN)ü§ñ Executando: @architect *create-doc brownfield-architecture$(NC)"
	@gemini -p "@architect *create-doc brownfield-architecture" || \
		(echo "$(RED)‚ùå Erro na cria√ß√£o da arquitetura$(NC)" && exit 1)
	@echo "$(GREEN)‚úÖ Arquitetura para brownfield criada!$(NC)"
	@echo "$(BLUE)üìÑ Documento gerado: docs/architecture.md$(NC)"

validate: ## ‚úÖ Executar checklist de valida√ß√£o
	@echo "$(GREEN)‚úÖ Executando checklist de valida√ß√£o...$(NC)"
	@echo "$(YELLOW)‚è±Ô∏è  Tempo estimado: 10-15 minutos$(NC)"
	@echo "$(YELLOW)üí° Revise cada item apresentado cuidadosamente$(NC)"
	@echo "$(CYAN)ü§ñ Executando: @po *execute-checklist po-master-checklist$(NC)"
	@gemini -p "@po *execute-checklist po-master-checklist" || \
		(echo "$(RED)‚ùå Erro na valida√ß√£o$(NC)" && exit 1)
	@echo "$(GREEN)‚úÖ Valida√ß√£o conclu√≠da!$(NC)"

##@ Cria√ß√£o de √âpicos e Hist√≥rias

create-epic: ## üìù Criar √©pico para brownfield
	@echo "$(PURPLE)üìù Criando √©pico para projeto brownfield...$(NC)"
	@echo "$(YELLOW)üí° Voc√™ definir√° nome, objetivo e crit√©rios de sucesso$(NC)"
	@echo "$(CYAN)ü§ñ Executando: @pm *brownfield-create-epic$(NC)"
	@gemini -p "@pm *brownfield-create-epic" || \
		(echo "$(RED)‚ùå Erro na cria√ß√£o do √©pico$(NC)" && exit 1)
	@echo "$(GREEN)‚úÖ √âpico criado com sucesso!$(NC)"

create-stories: ## üìñ Criar hist√≥rias de usu√°rio detalhadas
	@echo "$(BLUE)üìñ Criando hist√≥rias de usu√°rio...$(NC)"
	@echo "$(YELLOW)üí° Execute m√∫ltiplas vezes para criar v√°rias hist√≥rias$(NC)"
	@echo "$(CYAN)ü§ñ Executando: @sm create-next-story$(NC)"
	@gemini -p "@sm create-next-story" || \
		(echo "$(RED)‚ùå Erro na cria√ß√£o da hist√≥ria$(NC)" && exit 1)
	@echo "$(GREEN)‚úÖ Hist√≥ria criada!$(NC)"
	@echo "$(BLUE)üí° Para criar mais hist√≥rias, execute: make create-stories$(NC)"

##@ Implementa√ß√£o

implement-story: ## üíª Implementar hist√≥ria espec√≠fica
	@echo "$(GREEN)üíª Implementando hist√≥ria $(STORY_NUMBER)...$(NC)"
	@echo "$(YELLOW)üí° Use STORY_NUMBER=X.Y para especificar a hist√≥ria$(NC)"
	@echo "$(CYAN)ü§ñ Executando: @dev implement story $(STORY_NUMBER)$(NC)"
	@gemini -p "@dev implement story $(STORY_NUMBER)" || \
		(echo "$(RED)‚ùå Erro na implementa√ß√£o da hist√≥ria$(NC)" && exit 1)
	@echo "$(GREEN)‚úÖ Hist√≥ria $(STORY_NUMBER) implementada!$(NC)"

refactor: ## üîß Refatorar c√≥digo existente
	@echo "$(YELLOW)üîß Iniciando processo de refatora√ß√£o...$(NC)"
	@echo "$(BLUE)üìä Passo 1: Analisando projeto atual...$(NC)"
	@gemini -p "@analyst *document-project"
	@echo "$(BLUE)üèóÔ∏è  Passo 2: Revisando arquitetura...$(NC)"
	@gemini -p "@architect *review-architecture"
	@echo "$(BLUE)üìã Passo 3: Planejando refatora√ß√£o...$(NC)"
	@gemini -p "@pm *create-doc brownfield-prd"
	@echo "$(GREEN)‚úÖ An√°lise de refatora√ß√£o conclu√≠da!$(NC)"
	@echo "$(YELLOW)üí° Pr√≥ximo passo: Especifique o componente a refatorar$(NC)"
	@echo "$(CYAN)üí° Exemplo: gemini -p '@dev refactor [nome-do-componente]'$(NC)"

fix-bug: ## üêõ Processo para corrigir bug complexo
	@echo "$(RED)üêõ Iniciando processo de corre√ß√£o de bug...$(NC)"
	@echo "$(BLUE)üìä Passo 1: Analisando problema...$(NC)"
	@gemini -p "@analyst *document-project"
	@echo "$(GREEN)‚úÖ An√°lise inicial conclu√≠da!$(NC)"
	@echo "$(YELLOW)üí° Pr√≥ximos passos manuais:$(NC)"
	@echo "$(CYAN)  1. gemini -p '@dev analyze bug [descri√ß√£o-do-bug]'$(NC)"
	@echo "$(CYAN)  2. gemini -p '@architect *design-fix [bug]'$(NC)"
	@echo "$(CYAN)  3. gemini -p '@dev fix [bug]'$(NC)"
	@echo "$(CYAN)  4. gemini -p '@qa validate [corre√ß√£o]'$(NC)"

migrate: ## üîÑ Processo de migra√ß√£o de tecnologia
	@echo "$(PURPLE)üîÑ Iniciando processo de migra√ß√£o...$(NC)"
	@echo "$(BLUE)üìä Passo 1: Documentando estado atual...$(NC)"
	@gemini -p "@analyst *document-project"
	@echo "$(GREEN)‚úÖ Documenta√ß√£o inicial conclu√≠da!$(NC)"
	@echo "$(YELLOW)üí° Pr√≥ximos passos manuais:$(NC)"
	@echo "$(CYAN)  1. gemini -p '@architect *create-doc migration-architecture'$(NC)"
	@echo "$(CYAN)  2. gemini -p '@pm *create-migration-roadmap'$(NC)"
	@echo "$(CYAN)  3. gemini -p '@po *execute-checklist migration-checklist'$(NC)"
	@echo "$(CYAN)  4. gemini -p '@dev implement migration-phase [n√∫mero]'$(NC)"

##@ Utilit√°rios

status: ## üìä Verificar status das instala√ß√µes
	@echo "$(CYAN)üìä Status do ambiente BMAD-Method:$(NC)"
	@echo ""
	@echo "$(BLUE)üîß Depend√™ncias:$(NC)"
	@printf "  Node.js: "
	@node --version 2>/dev/null && echo "$(GREEN)‚úÖ$(NC)" || echo "$(RED)‚ùå$(NC)"
	@printf "  npm: "
	@npm --version 2>/dev/null && echo "$(GREEN)‚úÖ$(NC)" || echo "$(RED)‚ùå$(NC)"
	@printf "  Gemini CLI: "
	@gemini --version 2>/dev/null && echo "$(GREEN)‚úÖ$(NC)" || echo "$(RED)‚ùå$(NC)"
	@echo ""
	@echo "$(BLUE)üîë Configura√ß√£o:$(NC)"
	@printf "  Autentica√ß√£o OAuth: "
	@echo "$(GREEN)‚úÖ Configurada (sem necessidade de API Key)$(NC)"
	@echo ""
	@echo "$(BLUE)üìÅ Estrutura do Projeto:$(NC)"
	@printf "  core-config.yml: "
	@if [ -f "core-config.yml" ]; then echo "$(GREEN)‚úÖ Existe$(NC)"; else echo "$(YELLOW)‚ö†Ô∏è  N√£o encontrado$(NC)"; fi
	@printf "  docs/: "
	@if [ -d "docs" ]; then echo "$(GREEN)‚úÖ Existe$(NC)"; else echo "$(YELLOW)‚ö†Ô∏è  N√£o encontrado$(NC)"; fi
	@printf "  .gemini/: "
	@if [ -d ".gemini" ]; then echo "$(GREEN)‚úÖ Existe$(NC)"; else echo "$(YELLOW)‚ö†Ô∏è  N√£o encontrado$(NC)"; fi
	@echo ""
	@echo "$(BLUE)üìä Status BMAD-Method:$(NC)"
	@npx bmad-method status 2>/dev/null || echo "$(YELLOW)‚ö†Ô∏è  Execute 'make setup-bmad' para configurar$(NC)"

clean-docs: ## üßπ Limpar documenta√ß√£o gerada
	@echo "$(YELLOW)üßπ Limpando documenta√ß√£o gerada...$(NC)"
	@if [ -d "docs" ]; then \
		echo "$(BLUE)üìÅ Removendo docs/...$(NC)"; \
		rm -rf docs/; \
	fi
	@if [ -d ".ai" ]; then \
		echo "$(BLUE)üìÅ Removendo .ai/...$(NC)"; \
		rm -rf .ai/; \
	fi
	@if [ -f "core-config.yml" ]; then \
		echo "$(BLUE)üìÑ Removendo core-config.yml...$(NC)"; \
		rm -f core-config.yml; \
	fi
	@echo "$(GREEN)‚úÖ Documenta√ß√£o limpa!$(NC)"
	@echo "$(YELLOW)üí° Execute 'make setup-bmad' para reconfigurar$(NC)"

##@ Comandos de Desenvolvimento

dev-help: ## üõ†Ô∏è Comandos √∫teis para desenvolvimento
	@echo "$(CYAN)üõ†Ô∏è  Comandos √∫teis do Gemini CLI:$(NC)"
	@echo ""
	@echo "$(YELLOW)üìä Sistema:$(NC)"
	@echo "  $(GREEN)gemini -p '/help'$(NC)          - Ajuda do Gemini CLI"
	@echo "  $(GREEN)gemini -p '/stats'$(NC)         - Estat√≠sticas de uso"
	@echo "  $(GREEN)gemini -p '/about'$(NC)         - Informa√ß√µes da vers√£o"
	@echo ""
	@echo "$(YELLOW)üìÅ Arquivos:$(NC)"
	@echo "  $(GREEN)gemini -p '@arquivo.txt Analise este arquivo'$(NC)"
	@echo "  $(GREEN)gemini -p '@src/ Revise este c√≥digo'$(NC)"
	@echo ""
	@echo "$(YELLOW)üîß Shell:$(NC)"
	@echo "  $(GREEN)gemini -p '!ls -la'$(NC)        - Executar comando shell"
	@echo "  $(GREEN)gemini -p '!git status'$(NC)    - Status do git"
	@echo ""
	@echo "$(YELLOW)üé® Configura√ß√£o:$(NC)"
	@echo "  $(GREEN)gemini -p '/theme'$(NC)         - Alterar tema"
	@echo "  $(GREEN)gemini -p '/memory show'$(NC)   - Mostrar contexto"

# Valida√ß√µes internas
_check_oauth:
	@echo "$(BLUE)üîê Verificando autentica√ß√£o OAuth...$(NC)"
	@gemini -p "test" >/dev/null 2>&1 || \
		(echo "$(RED)‚ùå Problema na autentica√ß√£o OAuth!$(NC)" && \
		 echo "$(YELLOW)üí° Execute: make setup-oauth$(NC)" && exit 1)

_check_gemini_cli:
	@if ! command -v gemini >/dev/null 2>&1; then \
		echo "$(RED)‚ùå Gemini CLI n√£o est√° instalado!$(NC)"; \
		echo "$(YELLOW)üí° Execute: make setup-gemini$(NC)"; \
		exit 1; \
	fi

# Adicionar valida√ß√µes aos comandos que precisam
analyze plan-prd plan-arch validate create-epic create-stories implement-story: _check_oauth _check_gemini_cli

# Informa√ß√µes do projeto
info:
	@echo "$(CYAN)‚ÑπÔ∏è  Informa√ß√µes do Projeto:$(NC)"
	@echo "  Nome: $(PROJECT_NAME)"
	@echo "  Diret√≥rio: $(PWD)"
	@echo "  Makefile: $(MAKEFILE_LIST)"